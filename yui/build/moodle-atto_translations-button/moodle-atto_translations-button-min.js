YUI.add("moodle-atto_translations-button",function(a,t){var e={CONFIRMTEXT:"atto_translations_confirmtext"},s=".submit",n=".cancel",i={translationhashregex:/<span\s*data-translationhash\s*=\s*['"]+([a-zA-Z0-9]+)['"]+\s*>\s*<\/span>/g,newtranslationhashregex:/<p class="translationhash">\s*<span\s*data-translationhash\s*=\s*['"]+([a-zA-Z0-9]+)['"]+\s*>\s*<\/span>\s*<\/p>/,_content:null,initializer:function(){var t,a,e,s,n,o=null;if(this.get("showreplacebutton")&&(o=this.addButton({icon:"icon",iconComponent:"atto_translations",callback:this._displayDialogue,title:"replacehash"})),e=(a=this.get("host")).textarea.get("value"),s=this.get("unusedhash"),n=i.newtranslationhashregex.exec(e),s&&!n){if(n=i.translationhashregex.exec(e))return n=n[1],e=e.replaceAll(i.translationhashregex,""),t='<p class="translationhash"><span data-translationhash="'+n+'"></span></p>',a.textarea.set("value",t+e),void a.updateFromTextArea();t='<p class="translationhash"><span data-translationhash="'+s+'"></span></p>',a.textarea.set("value",t+e),a.updateFromTextArea(),null!==o&&o.setAttribute("disabled","disabled"),(n=a.textarea.ancestor("form"))&&n.on("submit",function(){a.textarea.get("value")===t&&(a.textarea.set("value",""),a.updateFromTextArea())},this)}},_replaceHash:function(t){var a,e=/<span data-translationhash[ ]*=[ ]*[\'"]+([a-zA-Z0-9]+)[\'"]+[ ]*>[ ]*<\/span>/g,s=/(?:<p>|<p class="translationhash">)\s*<span\s*data-translationhash\s*=\s*['"]+([a-zA-Z0-9]+)['"]+\s*>\s*<\/span>\s*<\/p>/g,n=this.get("unusedhash");this._closeDialogue(t),a=(a=(a=(t=this.get("host")).textarea.get("value")).replaceAll(s,"")).replaceAll(e,""),t.textarea.set("value",'<p class="translationhash"><span data-translationhash="'+n+'"></span></p>'+a),t.updateFromTextArea()},_closeDialogue:function(t){t.preventDefault(),this.getDialogue({focusAfterHide:null}).hide()},_displayDialogue:function(){var t=this.getDialogue({headerContent:M.util.get_string("confirm","moodle"),width:"auto",focusAfterHide:!0});t.set("bodyContent",this._getDialogueContent()),t.show()},_getDialogueContent:function(){var t=a.Handlebars.compile('<form class="atto_form"><div class="mb-1"><label for="{{elementid}}_atto_translations_confirmtext">{{get_string "confirmtext" component}}</label></div><div class="mdl-align"><br/><button type="button" class="btn btn-primary submit">{{get_string "yes" "moodle"}}</button> <button type="button" class="btn btn-secondary cancel">{{get_string "cancel" "moodle"}}</button></div></form>');return this._content=a.Node.create(t({component:"atto_translations",CSS:e})),this._content.one(s).on("click",this._replaceHash,this),this._content.one(n).on("click",this._closeDialogue,this),this._content}};a.namespace("M.atto_translations").Button=a.Base.create("button",a.M.editor_atto.EditorPlugin,[],i,{ATTRS:{unusedhash:{value:!1},showreplacebutton:{value:!1}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});